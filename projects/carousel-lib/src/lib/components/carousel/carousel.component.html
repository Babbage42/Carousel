<div [innerHTML]="generatedStyles"></div>

<div
  #carousel
  class="carousel"
  [class.layout-ready]="layoutReady()"
  [class.carousel--center]="applyCenterAtInit()"
  [style.padding-left.px]="peekEdgesOffset()"
  [style.padding-right.px]="peekEdgesOffset()"
>
  @if(debug()) {
  <span>total slides:{{ totalSlides() }}</span>
  <span>current anchor:{{ currentPosition() }}</span>
  <span>real position:{{ currentRealPosition() }}</span>
  }

  <div class="slides-wrapper">
    @if (showControls()) {
    <app-navigation
      [alwaysShowControls]="alwaysShowControls()"
      [customLeftArrow]="customLeftArrow?.templateRef"
      [customRightArrow]="customRightArrow?.templateRef"
      (slidePrev)="slideToPrev()"
      (slideNext)="slideToNext()"
      (slideTo)="slideTo($event)"
      [loop]="loop()"
      [rewind]="rewind()"
      [currentPosition]="currentPosition()"
      [totalSlides]="totalSlides()"
      [iconSize]="iconSize()"
    >
    </app-navigation>
    }

    <div
      #allSlides
      class="slides"
      aria-live="polite"
      [class.slides-auto]="slidesPerView() === 'auto'"
      [class.fix-subpixel]="fixSubPixelIssue()"
      [style.transform]="slidesTransform()"
      [style.transition-duration.ms]="transitionDuration()"
      [style.gap]="slidesGap()"
      [style.grid-auto-columns]="slidesGridColumns()"
      appImagesReady
      (imagesReady)="onImagesReady()"
      (imagesChanged)="onImagesChanged()"
    >
      @if (slides().length) { @for (slide of slides(); track $index) {
      <div
        #slide
        class="slide position-{{ $index + 1 }}"
        [class.slide--disabled]="isSlideDisabled($index)"
      >
        <img src="{{ slide.image }}" alt="" />

        @if(debug()) {
        <span>{{ $index + 1 }}</span>
        }
      </div>
      } } @else if (projectedSlides().length) { @for (slide of
      projectedSlides(); track $index) {
      <ng-container>
        <div
          #slide
          class="slide position-{{ $index + 1 }}"
          [class.slide--disabled]="isSlideDisabled($index)"
        >
          <ng-container *ngTemplateOutlet="slide.templateRef"></ng-container>
        </div>
      </ng-container>
      } } @else {
      <ng-content></ng-content>
      }
    </div>

    @if(thumbsFor() && thumbsOptions().selectionBar) {
    <div
      class="carousel-thumb-indicator"
      [style.transform]="'translateX(' + thumbIndicatorLeft() + 'px)'"
      [style.transition-duration.ms]="thumbsTransitionDuration()"
      [style.width.px]="thumbIndicatorWidth()"
    ></div>
    }
  </div>

  @if (store.pagination() && !store.pagination()!.external) {
  <ng-container *ngTemplateOutlet="paginationTemplate"></ng-container>
  }
</div>

<ng-template #paginationTemplate>
  @if (store.pagination()) {
  <app-pagination
    (goToSlide)="slideTo($event)"
    [currentPosition]="currentPosition()"
    [firstSlideAnchor]="firstSlideAnchor()"
    [lastSlideAnchor]="lastSlideAnchor()"
    [totalSlides]="totalSlides()"
    [totalSlidesVisible]="totalSlidesVisible()"
    [pagination]="pagination()!"
  ></app-pagination>
  }
</ng-template>
